---
import '../styles/adminStyle.css';
import ProposalForm from './ProposalForm.astro';
---

    <div class="admin-container">
        <div class="admin-header">
            <h1>ğŸš€ Cloud Pixels - Panel de AdministraciÃ³n</h1>
            <p>Sistema de GestiÃ³n de Propuestas Personalizadas</p>

        </div>

        <div class="tabs">
            <button class="tab active" data-tab="create">ğŸ“ Crear Nueva Propuesta</button>
            <button class="tab" data-tab="list">ğŸ“‹ Lista de Propuestas</button>
        </div>

        <!-- Tab: Crear Nueva Propuesta -->
        <div id="create-tab" class="tab-content active">
            <ProposalForm mode="create" formId="proposalForm" />
            
            <div class="success-message" id="successMessage">
                <div id="successContent">
                    âœ… Â¡Propuesta generada exitosamente! Se ha guardado en la base de datos.
                </div>
                <div id="proposalLinkSection" style="display: none; margin-top: 15px;">
                    <p style="margin-bottom: 10px;"><strong>ğŸŒ Tu propuesta estÃ¡ lista para ver:</strong></p>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center;">
                        <a id="openProposalBtn" href="#" target="_blank" class="btn btn-primary" style="text-decoration: none;">
                            ğŸš€ Abrir Propuesta Ahora
                        </a>
                        <button type="button" class="btn btn-secondary" data-action="copy-proposal-link">
                            ğŸ“‹ Copiar Enlace
                        </button>
                    </div>
                    <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                        <strong>CÃ³digo de la propuesta:</strong> <code id="proposalCodeDisplay"></code>
                    </div>
                    <div style="margin-top: 15px; padding: 10px; background: rgba(40, 167, 69, 0.1); border-radius: 6px; border-left: 4px solid #28a745;">
                        <p style="margin: 0; color: #155724; font-size: 0.9em;">
                            <strong>â° RedirecciÃ³n automÃ¡tica:</strong> Se abrirÃ¡ la propuesta en una nueva pestaÃ±a en <span class="countdown">3</span> segundos...
                        </p>
                    </div>
                </div>
            </div>
            <div class="error-message" id="errorMessage">
                âŒ Error al generar la propuesta. Por favor, verifica los datos e intenta nuevamente.
            </div>
        </div>

        <!-- Tab: Lista de Propuestas -->
        <div id="list-tab" class="tab-content">
            <div class="form-section">
                <h3>ğŸ“‹ Propuestas Creadas</h3>
                <div id="proposalsList" class="proposals-list">
                    <!-- Las propuestas se cargarÃ¡n dinÃ¡micamente aquÃ­ -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para editar propuesta -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>âœï¸ Editar Propuesta</h2>
                <span class="close" data-action="close-modal">&times;</span>
            </div>
            <div id="editFormContainer">
                <!-- El formulario de ediciÃ³n se cargarÃ¡ aquÃ­ dinÃ¡micamente -->
            </div>
        </div>
    </div>

    <!-- Modal para vista previa -->
    <div id="previewModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ‘ï¸ Vista Previa de la Propuesta</h2>
                <span class="close" data-action="close-preview-modal">&times;</span>
            </div>
            <div id="previewContent" style="max-height: 60vh; overflow-y: auto; border: 1px solid #e1e5e9; padding: 20px; border-radius: 8px;">
                <!-- El contenido de la propuesta se mostrarÃ¡ aquÃ­ -->
            </div>
        </div>
    </div>

    <script type="module" src="../scripts/admin-main.js"></script>
   

